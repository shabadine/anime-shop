{% extends 'base.html.twig' %}

{% block title %}Accueil - Anime Goodies Shop{% endblock %}

{% block body %}

<header class="hero-section py-5 position-relative text-white" role="banner"
      style="background: url('{{ asset('images/hero-anime.jpg') }}') center/cover no-repeat;">
  <div class="position-absolute top-0 start-0 w-100 h-100 bg-dark opacity-50"></div>
  <div class="container position-relative z-1 text-center">
    <h1 id="hero-title" class="hero-title">
        Anime Goodies Shop
        <img src="{{ asset('images/logo.svg') }}"
            alt="Logo Anime Shop"
            width="60"
            height="60"
            loading="lazy">
    </h1>
    <p class="hero-subtitle mb-4">
      Les goodies officiels de tes animes préférés, livrés en 48h !
    </p>
    
    <a href="{{ path('app_catalog') }}" class="btn btn-lg px-5 py-3 btn-danger fw-bold" aria-label="Voir le catalogue des produits">
        <i class="bi bi-arrow-right"></i> Voir le catalogue
    </a>
  </div>
</header>

<section class="py-5" aria-labelledby="section-featured">
    <div class="container">
        <h2 id="section-featured" class="text-center section-title text-danger mb-5">Notre Sélection <i class="bi bi-fire"></i></h2>
        
        <div class="row g-4">
            {% for product in featuredProducts %}
                <div class="col-md-3">
                    <article class="card h-100 shadow-sm product-card position-relative" aria-labelledby="product-featured-{{ product.id }}">
                        {% if product.pricePromotion %}
                            <span class="badge bg-danger position-absolute top-0 start-0 m-2 z-1">
                                -{{ ((1 - (product.pricePromotion / product.price)) * 100)|round }}%
                            </span>
                        {% endif %}

                        {% if product.image %}
                            <img src="{{ asset('uploads/products/' ~ product.image) }}" 
                                 alt="{{ product.name }}" 
                                 class="card-img-top"
                                 width="300" height="300"
                                 style="object-fit: cover;">
                        {% endif %}

                        <div class="bg-dark text-white p-2">
                            <h3 id="product-featured-{{ product.id }}" class="h5 card-title text-center mb-0">
                                {{ product.name }}
                            </h3>
                        </div>

                        <div class="card-body d-flex flex-column">
                            <p class="text-muted small">Anime : {{ product.animeName }}</p>
                            <div class="mt-auto d-flex justify-content-between align-items-center">
                                <div>
                                    {% if product.pricePromotion %}
                                        <span class="text-muted text-decoration-line-through small">{{ product.price }}€</span>
                                        <span class="h4 mb-0 fw-bold text-danger ms-1">{{ product.pricePromotion }}€</span>
                                    {% else %}
                                        <span class="h4 mb-0 fw-bold text-danger">{{ product.price }}€</span>
                                    {% endif %}
                                </div>
                                <a href="{{ path('app_product_show', {slug: product.slug}) }}" 
                                   class="btn btn-outline-danger btn-sm"
                                   aria-label="Détails de {{ product.name }}">Voir</a>
                            </div>
                        </div>
                    </article>
                </div>
            {% endfor %}
        </div>
    </div>
</section>

<section class="py-5 bg-light" aria-labelledby="section-bestsellers">
    <div class="container">
        <h2 id="section-bestsellers" class="text-center mb-5"> Promotions <i class="bi bi-tag ms-2 text-danger"></i></h2>
        <div class="row g-4">
            {% for product in bestSellers %}
                <div class="col-md-3">
                    <div class="card shadow-sm h-100 position-relative">
                        {% if product.pricePromotion %}
                            <span class="badge bg-danger position-absolute top-0 start-0 m-2 z-1">PROMO</span>
                        {% endif %}

                        <img src="{{ asset('uploads/products/' ~ product.image) }}" 
                             alt="{{ product.name }}" 
                             class="card-img-top" 
                             style="height: 200px; object-fit: cover;">
                        <div class="card-body text-center">
                            <h5 class="card-title">{{ product.name }}</h5>
                            
                            {% if product.pricePromotion %}
                                <p class="mb-0 text-muted text-decoration-line-through small">{{ product.price }} €</p>
                                <p class="text-danger fw-bold fs-5">{{ product.pricePromotion }} €</p>
                            {% else %}
                                <p class="text-danger fw-bold fs-5">{{ product.price }} €</p>
                            {% endif %}

                             <a href="{{ path('app_product_show', {slug: product.slug}) }}" 
                                class="btn btn-danger btn-sm">Voir l'article</a>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</section>

<section class="py-5 bg-white border-top" role="region" aria-label="Appel à l'action">
    <div class="container text-center">
        <h2 class="h3">Envie de découvrir plus de produits ?</h2>
        <p class="lead">Explorez notre catalogue complet</p>
        <a href="{{ path('app_catalog') }}" class="btn btn-dark btn-lg">Voir tout le catalogue</a>
    </div>
</section>
{% endblock %}